{"ast":null,"code":"import { mapGetters } from 'vuex';\nexport default {\n  name: 'ScenarioModify',\n  props: {\n    id: {\n      type: [String, Number],\n      required: true\n    }\n  },\n  data() {\n    return {\n      userInput: '',\n      chatHistory: [],\n      modifying: false\n    };\n  },\n  computed: {\n    ...mapGetters(['currentScenario', 'isLoading', 'error'])\n  },\n  methods: {\n    formatKey(key) {\n      const keyMap = {\n        gender: '성별',\n        age: '나이',\n        medical_history: '과거력',\n        family_history: '가족력',\n        allergies: '알레르기',\n        vital_signs: '활력징후',\n        symptoms: '주요증상'\n      };\n      return keyMap[key] || key;\n    },\n    formatValue(value) {\n      if (Array.isArray(value)) {\n        return value.join(', ');\n      }\n      return value;\n    },\n    async sendMessage() {\n      if (!this.userInput.trim() || this.modifying) return;\n\n      // 사용자 메시지 추가\n      this.chatHistory.push({\n        sender: 'user',\n        content: this.userInput\n      });\n\n      // 입력 필드 초기화\n      const userInput = this.userInput;\n      this.userInput = '';\n\n      // 수정 중 상태로 변경\n      this.modifying = true;\n      try {\n        // 시나리오 수정 요청\n        const response = await this.$store.dispatch('modifyScenario', {\n          scenarioId: this.id,\n          userInput: userInput\n        });\n\n        // 챗봇 응답 추가\n        this.chatHistory.push({\n          sender: 'bot',\n          content: `시나리오가 성공적으로 수정되었습니다. 요청하신 \"${userInput}\"에 따라 시나리오 내용이 업데이트되었습니다. 시나리오 내용을 확인해보세요.`\n        });\n\n        // 시나리오 내용 새로고침\n        await this.$store.dispatch('fetchScenario', this.id);\n      } catch (error) {\n        // 오류 메시지 추가\n        this.chatHistory.push({\n          sender: 'bot',\n          content: `오류가 발생했습니다: ${error.message || '알 수 없는 오류'}`\n        });\n      } finally {\n        // 수정 중 상태 해제\n        this.modifying = false;\n      }\n    }\n  },\n  async created() {\n    // 시나리오 정보 로드\n    if (!this.currentScenario || this.currentScenario.id !== parseInt(this.id)) {\n      await this.$store.dispatch('fetchScenario', this.id);\n    }\n\n    // 초기 챗봇 메시지 추가\n    this.chatHistory.push({\n      sender: 'bot',\n      content: '안녕하세요! 시나리오 수정을 도와드리겠습니다. 어떤 부분을 수정하고 싶으신가요?'\n    });\n  }\n};","map":{"version":3,"names":["mapGetters","name","props","id","type","String","Number","required","data","userInput","chatHistory","modifying","computed","methods","formatKey","key","keyMap","gender","age","medical_history","family_history","allergies","vital_signs","symptoms","formatValue","value","Array","isArray","join","sendMessage","trim","push","sender","content","response","$store","dispatch","scenarioId","error","message","created","currentScenario","parseInt"],"sources":["D:\\간호시뮬레이션\\frontend\\src\\views\\ScenarioModify.vue"],"sourcesContent":["<template>\r\n  <div class=\"scenario-modify\">\r\n    <div v-if=\"loading\" class=\"text-center my-5\">\r\n      <div class=\"spinner-border text-primary\" role=\"status\">\r\n        <span class=\"visually-hidden\">로딩 중...</span>\r\n      </div>\r\n      <p class=\"mt-3\">시나리오를 불러오는 중입니다...</p>\r\n    </div>\r\n    \r\n    <div v-else-if=\"error\" class=\"alert alert-danger my-5\">\r\n      {{ error }}\r\n    </div>\r\n    \r\n    <div v-else-if=\"!currentScenario\" class=\"alert alert-warning my-5\">\r\n      시나리오를 찾을 수 없습니다.\r\n    </div>\r\n    \r\n    <div v-else>\r\n      <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n        <h1>시나리오 수정</h1>\r\n        <router-link :to=\"{ name: 'ScenarioDetail', params: { id } }\" class=\"btn btn-outline-secondary\">\r\n          돌아가기\r\n        </router-link>\r\n      </div>\r\n      \r\n      <div class=\"card mb-4\">\r\n        <div class=\"card-header bg-primary text-white\">\r\n          <h2 class=\"h5 mb-0\">{{ currentScenario.title }}</h2>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"mb-3\">\r\n            <h3 class=\"h6\">주요 질병</h3>\r\n            <p>{{ currentScenario.main_disease }}</p>\r\n          </div>\r\n          \r\n          <div class=\"mb-3\">\r\n            <h3 class=\"h6\">기본 인적 사항</h3>\r\n            <ul class=\"list-group list-group-flush\">\r\n              <li class=\"list-group-item\" v-for=\"(value, key) in currentScenario.personal_info\" :key=\"key\">\r\n                <strong>{{ formatKey(key) }}:</strong> {{ formatValue(value) }}\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          \r\n          <div v-if=\"currentScenario.additional_info\">\r\n            <h3 class=\"h6\">기타 사항</h3>\r\n            <p>{{ currentScenario.additional_info }}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"card mb-4\">\r\n        <div class=\"card-header bg-light\">\r\n          <h3 class=\"h5 mb-0\">현재 시나리오 내용</h3>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"scenario-content\">\r\n            <pre class=\"scenario-text\">{{ currentScenario.content }}</pre>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"card\">\r\n        <div class=\"card-header bg-light\">\r\n          <h3 class=\"h5 mb-0\">챗봇을 통한 시나리오 수정</h3>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"chat-container mb-4\">\r\n            <div v-for=\"(message, index) in chatHistory\" :key=\"index\" \r\n                 :class=\"['chat-message', message.sender === 'user' ? 'user-message' : 'bot-message']\">\r\n              <div class=\"message-content\">\r\n                <p v-if=\"message.sender === 'user'\">\r\n                  <strong>사용자:</strong> {{ message.content }}\r\n                </p>\r\n                <div v-else>\r\n                  <p><strong>챗봇:</strong></p>\r\n                  <pre class=\"bot-response\">{{ message.content }}</pre>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <form @submit.prevent=\"sendMessage\" class=\"chat-input\">\r\n            <div class=\"input-group\">\r\n              <textarea \r\n                class=\"form-control\" \r\n                v-model=\"userInput\" \r\n                placeholder=\"시나리오 수정 요청을 입력하세요. 예: '환자의 나이를 65세로 변경해주세요.'\" \r\n                rows=\"3\"\r\n                :disabled=\"modifying\"\r\n              ></textarea>\r\n              <button \r\n                type=\"submit\" \r\n                class=\"btn btn-primary\" \r\n                :disabled=\"!userInput.trim() || modifying\"\r\n              >\r\n                <span v-if=\"modifying\" class=\"spinner-border spinner-border-sm me-2\" role=\"status\" aria-hidden=\"true\"></span>\r\n                전송\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n  name: 'ScenarioModify',\r\n  props: {\r\n    id: {\r\n      type: [String, Number],\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      userInput: '',\r\n      chatHistory: [],\r\n      modifying: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['currentScenario', 'isLoading', 'error'])\r\n  },\r\n  methods: {\r\n    formatKey(key) {\r\n      const keyMap = {\r\n        gender: '성별',\r\n        age: '나이',\r\n        medical_history: '과거력',\r\n        family_history: '가족력',\r\n        allergies: '알레르기',\r\n        vital_signs: '활력징후',\r\n        symptoms: '주요증상'\r\n      }\r\n      \r\n      return keyMap[key] || key\r\n    },\r\n    formatValue(value) {\r\n      if (Array.isArray(value)) {\r\n        return value.join(', ')\r\n      }\r\n      return value\r\n    },\r\n    async sendMessage() {\r\n      if (!this.userInput.trim() || this.modifying) return\r\n      \r\n      // 사용자 메시지 추가\r\n      this.chatHistory.push({\r\n        sender: 'user',\r\n        content: this.userInput\r\n      })\r\n      \r\n      // 입력 필드 초기화\r\n      const userInput = this.userInput\r\n      this.userInput = ''\r\n      \r\n      // 수정 중 상태로 변경\r\n      this.modifying = true\r\n      \r\n      try {\r\n        // 시나리오 수정 요청\r\n        const response = await this.$store.dispatch('modifyScenario', {\r\n          scenarioId: this.id,\r\n          userInput: userInput\r\n        })\r\n        \r\n        // 챗봇 응답 추가\r\n        this.chatHistory.push({\r\n          sender: 'bot',\r\n          content: `시나리오가 성공적으로 수정되었습니다. 요청하신 \"${userInput}\"에 따라 시나리오 내용이 업데이트되었습니다. 시나리오 내용을 확인해보세요.`\r\n        })\r\n        \r\n        // 시나리오 내용 새로고침\r\n        await this.$store.dispatch('fetchScenario', this.id)\r\n      } catch (error) {\r\n        // 오류 메시지 추가\r\n        this.chatHistory.push({\r\n          sender: 'bot',\r\n          content: `오류가 발생했습니다: ${error.message || '알 수 없는 오류'}`\r\n        })\r\n      } finally {\r\n        // 수정 중 상태 해제\r\n        this.modifying = false\r\n      }\r\n    }\r\n  },\r\n  async created() {\r\n    // 시나리오 정보 로드\r\n    if (!this.currentScenario || this.currentScenario.id !== parseInt(this.id)) {\r\n      await this.$store.dispatch('fetchScenario', this.id)\r\n    }\r\n    \r\n    // 초기 챗봇 메시지 추가\r\n    this.chatHistory.push({\r\n      sender: 'bot',\r\n      content: '안녕하세요! 시나리오 수정을 도와드리겠습니다. 어떤 부분을 수정하고 싶으신가요?'\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.scenario-modify {\r\n  max-width: 900px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.scenario-content {\r\n  max-height: 300px;\r\n  overflow-y: auto;\r\n  background-color: #f8f9fa;\r\n  border-radius: 5px;\r\n  padding: 15px;\r\n}\r\n\r\n.scenario-text {\r\n  white-space: pre-wrap;\r\n  font-family: 'Noto Sans KR', sans-serif;\r\n  font-size: 0.9rem;\r\n  margin: 0;\r\n}\r\n\r\n.chat-container {\r\n  max-height: 400px;\r\n  overflow-y: auto;\r\n  border: 1px solid #dee2e6;\r\n  border-radius: 5px;\r\n  padding: 15px;\r\n  background-color: #f8f9fa;\r\n}\r\n\r\n.chat-message {\r\n  margin-bottom: 15px;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.user-message {\r\n  align-items: flex-end;\r\n}\r\n\r\n.bot-message {\r\n  align-items: flex-start;\r\n}\r\n\r\n.message-content {\r\n  max-width: 80%;\r\n  padding: 10px 15px;\r\n  border-radius: 10px;\r\n}\r\n\r\n.user-message .message-content {\r\n  background-color: #007bff;\r\n  color: white;\r\n}\r\n\r\n.bot-message .message-content {\r\n  background-color: #e9ecef;\r\n  color: #212529;\r\n}\r\n\r\n.bot-response {\r\n  white-space: pre-wrap;\r\n  font-family: 'Noto Sans KR', sans-serif;\r\n  font-size: 0.9rem;\r\n  margin: 0;\r\n}\r\n\r\n.chat-input {\r\n  margin-top: 15px;\r\n}\r\n</style> "],"mappings":"AA4GA,SAASA,UAAS,QAAS,MAAK;AAEhC,eAAe;EACbC,IAAI,EAAE,gBAAgB;EACtBC,KAAK,EAAE;IACLC,EAAE,EAAE;MACFC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;MACtBC,QAAQ,EAAE;IACZ;EACF,CAAC;EACDC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE,EAAE;MACbC,WAAW,EAAE,EAAE;MACfC,SAAS,EAAE;IACb;EACF,CAAC;EACDC,QAAQ,EAAE;IACR,GAAGZ,UAAU,CAAC,CAAC,iBAAiB,EAAE,WAAW,EAAE,OAAO,CAAC;EACzD,CAAC;EACDa,OAAO,EAAE;IACPC,SAASA,CAACC,GAAG,EAAE;MACb,MAAMC,MAAK,GAAI;QACbC,MAAM,EAAE,IAAI;QACZC,GAAG,EAAE,IAAI;QACTC,eAAe,EAAE,KAAK;QACtBC,cAAc,EAAE,KAAK;QACrBC,SAAS,EAAE,MAAM;QACjBC,WAAW,EAAE,MAAM;QACnBC,QAAQ,EAAE;MACZ;MAEA,OAAOP,MAAM,CAACD,GAAG,KAAKA,GAAE;IAC1B,CAAC;IACDS,WAAWA,CAACC,KAAK,EAAE;MACjB,IAAIC,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE;QACxB,OAAOA,KAAK,CAACG,IAAI,CAAC,IAAI;MACxB;MACA,OAAOH,KAAI;IACb,CAAC;IACD,MAAMI,WAAWA,CAAA,EAAG;MAClB,IAAI,CAAC,IAAI,CAACpB,SAAS,CAACqB,IAAI,CAAC,KAAK,IAAI,CAACnB,SAAS,EAAE;;MAE9C;MACA,IAAI,CAACD,WAAW,CAACqB,IAAI,CAAC;QACpBC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE,IAAI,CAACxB;MAChB,CAAC;;MAED;MACA,MAAMA,SAAQ,GAAI,IAAI,CAACA,SAAQ;MAC/B,IAAI,CAACA,SAAQ,GAAI,EAAC;;MAElB;MACA,IAAI,CAACE,SAAQ,GAAI,IAAG;MAEpB,IAAI;QACF;QACA,MAAMuB,QAAO,GAAI,MAAM,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAC,gBAAgB,EAAE;UAC5DC,UAAU,EAAE,IAAI,CAAClC,EAAE;UACnBM,SAAS,EAAEA;QACb,CAAC;;QAED;QACA,IAAI,CAACC,WAAW,CAACqB,IAAI,CAAC;UACpBC,MAAM,EAAE,KAAK;UACbC,OAAO,EAAE,8BAA8BxB,SAAS;QAClD,CAAC;;QAED;QACA,MAAM,IAAI,CAAC0B,MAAM,CAACC,QAAQ,CAAC,eAAe,EAAE,IAAI,CAACjC,EAAE;MACrD,EAAE,OAAOmC,KAAK,EAAE;QACd;QACA,IAAI,CAAC5B,WAAW,CAACqB,IAAI,CAAC;UACpBC,MAAM,EAAE,KAAK;UACbC,OAAO,EAAE,eAAeK,KAAK,CAACC,OAAM,IAAK,WAAW;QACtD,CAAC;MACH,UAAU;QACR;QACA,IAAI,CAAC5B,SAAQ,GAAI,KAAI;MACvB;IACF;EACF,CAAC;EACD,MAAM6B,OAAOA,CAAA,EAAG;IACd;IACA,IAAI,CAAC,IAAI,CAACC,eAAc,IAAK,IAAI,CAACA,eAAe,CAACtC,EAAC,KAAMuC,QAAQ,CAAC,IAAI,CAACvC,EAAE,CAAC,EAAE;MAC1E,MAAM,IAAI,CAACgC,MAAM,CAACC,QAAQ,CAAC,eAAe,EAAE,IAAI,CAACjC,EAAE;IACrD;;IAEA;IACA,IAAI,CAACO,WAAW,CAACqB,IAAI,CAAC;MACpBC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;IACX,CAAC;EACH;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}