(()=>{"use strict";var e={7944:(e,t,a)=>{var o=a(5130),s=a(6768),r=a(4232);const n={id:"app"},i={class:"navbar navbar-expand-lg navbar-dark bg-primary"},l={class:"container"},c={class:"collapse navbar-collapse",id:"navbarNav"},d={class:"navbar-nav me-auto"},m={class:"nav-item"},u={class:"nav-item"},p={key:0,class:"nav-item"},h={class:"d-flex"},f={class:"navbar-text me-3"},g={class:"container mt-4"};function y(e,t,a,o,y,_){const v=(0,s.g2)("router-link"),k=(0,s.g2)("router-view"),b=(0,s.g2)("loading-spinner");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("nav",i,[(0,s.Lk)("div",l,[(0,s.bF)(v,{class:"navbar-brand",to:"/"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)("간호 시뮬레이션 시나리오 플랫폼")]))),_:1}),t[7]||(t[7]=(0,s.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,s.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,s.Lk)("div",c,[(0,s.Lk)("ul",d,[(0,s.Lk)("li",m,[(0,s.bF)(v,{class:"nav-link",to:"/"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("홈")]))),_:1})]),(0,s.Lk)("li",u,[(0,s.bF)(v,{class:"nav-link",to:"/scenarios"},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)("시나리오 목록")]))),_:1})]),e.isAdmin?((0,s.uX)(),(0,s.CE)("li",p,[(0,s.bF)(v,{class:"nav-link",to:"/create"},{default:(0,s.k6)((()=>t[4]||(t[4]=[(0,s.eW)("시나리오 생성")]))),_:1})])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",h,[e.isLoggedIn?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("span",f,(0,r.v_)(e.currentUser.username),1),(0,s.Lk)("button",{class:"btn btn-outline-light",onClick:t[0]||(t[0]=(...t)=>e.logout&&e.logout(...t))},"로그아웃")],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.bF)(v,{class:"btn btn-outline-light me-2",to:"/login"},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)("로그인")]))),_:1}),(0,s.bF)(v,{class:"btn btn-light",to:"/register"},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)("회원가입")]))),_:1})],64))])])])]),(0,s.Lk)("div",g,[(0,s.bF)(k)]),t[8]||(t[8]=(0,s.Lk)("footer",{class:"bg-light py-4 mt-5"},[(0,s.Lk)("div",{class:"container text-center"},[(0,s.Lk)("p",{class:"mb-0"},"© 2023 간호 시뮬레이션 시나리오 플랫폼. All rights reserved.")])],-1)),(0,s.bF)(b,{loading:e.isLoading,message:y.loadingMessage},null,8,["loading","message"])])}var _=a(782);const v={key:0,class:"loading-overlay"},k={class:"loading-spinner"},b={class:"loading-text"};function L(e,t,a,o,n,i){return a.loading?((0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("div",k,[t[0]||(t[0]=(0,s.Lk)("div",{class:"spinner"},null,-1)),(0,s.Lk)("p",b,(0,r.v_)(a.message||"처리 중입니다. 잠시만 기다려주세요..."),1)])])):(0,s.Q3)("",!0)}const S={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!1},message:{type:String,default:""}}};var E=a(1241);const w=(0,E.A)(S,[["render",L],["__scopeId","data-v-5df92b2d"]]),C=w,I={name:"App",components:{LoadingSpinner:C},data(){return{loadingMessage:""}},computed:{...(0,_.L8)(["isLoggedIn","currentUser","isAdmin","isLoading"])},methods:{...(0,_.i0)(["logout"]),updateLoadingMessage(e,t){e&&(this.loadingMessage=t||"처리 중입니다. 잠시만 기다려주세요...")}},created(){this.$store.dispatch("checkAuth"),this.$mitt.on("set-loading",(e=>{if(Array.isArray(e)){const[t,a]=e;this.updateLoadingMessage(t,a)}else if("object"===typeof e){const{loading:t,message:a}=e;this.updateLoadingMessage(t,a)}}))},beforeUnmount(){this.$mitt.off("set-loading")}},A=(0,E.A)(I,[["render",y]]),O=A;var R=a(1387);const T={class:"home"},x={class:"hero-section text-center py-5"},D={class:"d-flex justify-content-center gap-3"},N={class:"recent-scenarios-section py-5 bg-light"},X={class:"container"},U={key:0,class:"text-center"},$={key:1,class:"text-center"},P={key:2,class:"row row-cols-1 row-cols-md-3 g-4"},j={class:"card h-100"},F={class:"card-header bg-primary text-white"},W=["title"],V={class:"card-body"},G={class:"card-text"},J={class:"card-text"},Q={class:"card-footer bg-white border-top-0"},M={class:"text-center mt-4"};function H(e,t,a,o,n,i){const l=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",T,[(0,s.Lk)("div",x,[t[3]||(t[3]=(0,s.Lk)("h1",{class:"display-4 mb-4"},"간호 시뮬레이션 시나리오 플랫폼",-1)),t[4]||(t[4]=(0,s.Lk)("p",{class:"lead mb-5"},[(0,s.eW)(" 간호 교육을 위한 현실적인 시뮬레이션 시나리오를 생성하고 관리하세요."),(0,s.Lk)("br"),(0,s.eW)(" GPT-3.5 기반의 인공지능이 다양한 상황에 맞는 시나리오를 제공합니다. ")],-1)),(0,s.Lk)("div",D,[(0,s.bF)(l,{to:{name:"ScenarioList"},class:"btn btn-primary btn-lg"},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)(" 시나리오 목록 보기 ")]))),_:1}),e.isAdmin?((0,s.uX)(),(0,s.Wv)(l,{key:0,to:{name:"ScenarioCreate"},class:"btn btn-outline-primary btn-lg"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)(" 새 시나리오 생성 ")]))),_:1})):e.isLoggedIn?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(l,{key:1,to:{name:"Login"},class:"btn btn-outline-primary btn-lg"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 로그인 ")]))),_:1}))])]),t[12]||(t[12]=(0,s.Fv)('<div class="features-section py-5" data-v-7e205596><div class="container" data-v-7e205596><h2 class="text-center mb-5" data-v-7e205596>주요 기능</h2><div class="row g-4" data-v-7e205596><div class="col-md-4" data-v-7e205596><div class="card h-100" data-v-7e205596><div class="card-body text-center" data-v-7e205596><div class="feature-icon mb-3" data-v-7e205596><i class="bi bi-file-earmark-text display-4" data-v-7e205596></i></div><h3 class="card-title h5" data-v-7e205596>시나리오 생성</h3><p class="card-text" data-v-7e205596> 관리자 계정을 통해 다양한 간호 상황에 맞는 시나리오를 생성할 수 있습니다. 기본 인적 사항, 주요 질병, 기타 사항 등을 입력하면 GPT-3.5가 현실적인 시나리오를 생성합니다. </p></div></div></div><div class="col-md-4" data-v-7e205596><div class="card h-100" data-v-7e205596><div class="card-body text-center" data-v-7e205596><div class="feature-icon mb-3" data-v-7e205596><i class="bi bi-chat-dots display-4" data-v-7e205596></i></div><h3 class="card-title h5" data-v-7e205596>챗봇 기반 수정</h3><p class="card-text" data-v-7e205596> 챗봇 인터페이스를 통해 시나리오를 쉽게 수정할 수 있습니다. 원하는 변경 사항을 자연어로 입력하면 GPT-3.5가 시나리오를 적절히 수정합니다. </p></div></div></div><div class="col-md-4" data-v-7e205596><div class="card h-100" data-v-7e205596><div class="card-body text-center" data-v-7e205596><div class="feature-icon mb-3" data-v-7e205596><i class="bi bi-search display-4" data-v-7e205596></i></div><h3 class="card-title h5" data-v-7e205596>시나리오 열람</h3><p class="card-text" data-v-7e205596> 생성된 모든 시나리오는 사용자들이 자유롭게 열람할 수 있습니다. 시나리오명, 주요 질병 등으로 검색하여 원하는 시나리오를 쉽게 찾을 수 있습니다. </p></div></div></div></div></div></div>',1)),(0,s.Lk)("div",N,[(0,s.Lk)("div",X,[t[11]||(t[11]=(0,s.Lk)("h2",{class:"text-center mb-5"},"최근 생성된 시나리오",-1)),e.loading?((0,s.uX)(),(0,s.CE)("div",U,t[5]||(t[5]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"로딩 중...")],-1)]))):0===i.recentScenarios.length?((0,s.uX)(),(0,s.CE)("div",$,t[6]||(t[6]=[(0,s.Lk)("p",null,"아직 생성된 시나리오가 없습니다.",-1)]))):((0,s.uX)(),(0,s.CE)("div",P,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.recentScenarios,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"col",key:e.id},[(0,s.Lk)("div",j,[(0,s.Lk)("div",F,[(0,s.Lk)("h3",{class:"h5 mb-0 text-truncate",title:e.title},(0,r.v_)(e.title),9,W)]),(0,s.Lk)("div",V,[(0,s.Lk)("p",G,[t[7]||(t[7]=(0,s.Lk)("strong",null,"주요 질병:",-1)),(0,s.eW)(" "+(0,r.v_)(e.main_disease),1)]),(0,s.Lk)("p",J,[t[8]||(t[8]=(0,s.Lk)("strong",null,"생성일:",-1)),(0,s.eW)(" "+(0,r.v_)(i.formatDate(e.created_at)),1)])]),(0,s.Lk)("div",Q,[(0,s.bF)(l,{to:{name:"ScenarioDetail",params:{id:e.id}},class:"btn btn-outline-primary w-100"},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)(" 상세 보기 ")]))),_:2},1032,["to"])])])])))),128))])),(0,s.Lk)("div",M,[(0,s.bF)(l,{to:{name:"ScenarioList"},class:"btn btn-outline-primary"},{default:(0,s.k6)((()=>t[10]||(t[10]=[(0,s.eW)(" 모든 시나리오 보기 ")]))),_:1})])])])])}const K={name:"Home",computed:{...(0,_.L8)(["scenarios","isLoading","isLoggedIn","isAdmin"]),recentScenarios(){return this.scenarios&&Array.isArray(this.scenarios)?this.scenarios.slice(0,3):(console.warn("scenarios가 배열이 아닙니다:",this.scenarios),[])}},methods:{formatDate(e){if(!e)return"알 수 없음";const t=new Date(e);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(t)}},created(){this.$store.dispatch("fetchScenarios")}},q=(0,E.A)(K,[["render",H],["__scopeId","data-v-7e205596"]]),B=q,z={class:"login-page"},Y={class:"card"},Z={class:"card-body"},ee={key:0,class:"alert alert-danger"},te={class:"mb-3"},ae=["disabled"],oe={class:"mb-4"},se=["disabled"],re={class:"d-grid"},ne=["disabled"],ie={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},le={class:"mt-4 text-center"};function ce(e,t,a,n,i,l){const c=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",z,[(0,s.Lk)("div",Y,[t[8]||(t[8]=(0,s.Lk)("div",{class:"card-header bg-primary text-white text-center"},[(0,s.Lk)("h1",{class:"h4 mb-0"},"로그인")],-1)),(0,s.Lk)("div",Z,[e.error?((0,s.uX)(),(0,s.CE)("div",ee,(0,r.v_)(e.error),1)):(0,s.Q3)("",!0),(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>l.login&&l.login(...e)),["prevent"]))},[(0,s.Lk)("div",te,[t[3]||(t[3]=(0,s.Lk)("label",{for:"email",class:"form-label"},"이메일",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>i.form.email=e),required:"",disabled:e.loading},null,8,ae),[[o.Jo,i.form.email]])]),(0,s.Lk)("div",oe,[t[4]||(t[4]=(0,s.Lk)("label",{for:"password",class:"form-label"},"비밀번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>i.form.password=e),required:"",disabled:e.loading},null,8,se),[[o.Jo,i.form.password]])]),(0,s.Lk)("div",re,[(0,s.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:e.loading},[e.loading?((0,s.uX)(),(0,s.CE)("span",ie)):(0,s.Q3)("",!0),t[5]||(t[5]=(0,s.eW)(" 로그인 "))],8,ne)])],32),(0,s.Lk)("div",le,[(0,s.Lk)("p",null,[t[7]||(t[7]=(0,s.eW)("계정이 없으신가요? ")),(0,s.bF)(c,{to:{name:"Register"}},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.eW)("회원가입")]))),_:1})])])])])])}const de={name:"Login",data(){return{form:{email:"",password:""}}},computed:{...(0,_.L8)(["isLoading","error"])},methods:{async login(){try{await this.$store.dispatch("login",this.form);const e=this.$route.query.redirect||"/";this.$router.push(e)}catch(e){console.error("로그인 실패:",e)}}}},me=(0,E.A)(de,[["render",ce],["__scopeId","data-v-08576b04"]]),ue=me,pe={class:"register-page"},he={class:"card"},fe={class:"card-body"},ge={key:0,class:"alert alert-danger"},ye={class:"mb-3"},_e=["disabled"],ve={class:"mb-3"},ke=["disabled"],be={class:"mb-3"},Le=["disabled"],Se={class:"mb-4"},Ee=["disabled"],we={key:0,class:"text-danger mt-1"},Ce={class:"d-grid"},Ie=["disabled"],Ae={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Oe={class:"mt-4 text-center"};function Re(e,t,a,n,i,l){const c=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",pe,[(0,s.Lk)("div",he,[t[13]||(t[13]=(0,s.Lk)("div",{class:"card-header bg-primary text-white text-center"},[(0,s.Lk)("h1",{class:"h4 mb-0"},"회원가입")],-1)),(0,s.Lk)("div",fe,[e.error?((0,s.uX)(),(0,s.CE)("div",ge,(0,r.v_)(e.error),1)):(0,s.Q3)("",!0),(0,s.Lk)("form",{onSubmit:t[4]||(t[4]=(0,o.D$)(((...e)=>l.register&&l.register(...e)),["prevent"]))},[(0,s.Lk)("div",ye,[t[5]||(t[5]=(0,s.Lk)("label",{for:"username",class:"form-label"},"사용자명",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>i.form.username=e),required:"",disabled:e.loading},null,8,_e),[[o.Jo,i.form.username]])]),(0,s.Lk)("div",ve,[t[6]||(t[6]=(0,s.Lk)("label",{for:"email",class:"form-label"},"이메일",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>i.form.email=e),required:"",disabled:e.loading},null,8,ke),[[o.Jo,i.form.email]])]),(0,s.Lk)("div",be,[t[7]||(t[7]=(0,s.Lk)("label",{for:"password",class:"form-label"},"비밀번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>i.form.password=e),required:"",disabled:e.loading,minlength:"6"},null,8,Le),[[o.Jo,i.form.password]]),t[8]||(t[8]=(0,s.Lk)("div",{class:"form-text"},"비밀번호는 최소 6자 이상이어야 합니다.",-1))]),(0,s.Lk)("div",Se,[t[9]||(t[9]=(0,s.Lk)("label",{for:"password_confirm",class:"form-label"},"비밀번호 확인",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",class:"form-control",id:"password_confirm","onUpdate:modelValue":t[3]||(t[3]=e=>i.form.password_confirm=e),required:"",disabled:e.loading},null,8,Ee),[[o.Jo,i.form.password_confirm]]),l.passwordMismatch?((0,s.uX)(),(0,s.CE)("div",we," 비밀번호가 일치하지 않습니다. ")):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Ce,[(0,s.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:e.loading||l.passwordMismatch},[e.loading?((0,s.uX)(),(0,s.CE)("span",Ae)):(0,s.Q3)("",!0),t[10]||(t[10]=(0,s.eW)(" 회원가입 "))],8,Ie)])],32),(0,s.Lk)("div",Oe,[(0,s.Lk)("p",null,[t[12]||(t[12]=(0,s.eW)("이미 계정이 있으신가요? ")),(0,s.bF)(c,{to:{name:"Login"}},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)("로그인")]))),_:1})])])])])])}const Te={name:"Register",data(){return{form:{username:"",email:"",password:"",password_confirm:""}}},computed:{...(0,_.L8)(["isLoading","error"]),passwordMismatch(){return this.form.password&&this.form.password_confirm&&this.form.password!==this.form.password_confirm}},methods:{async register(){if(!this.passwordMismatch)try{await this.$store.dispatch("register",{username:this.form.username,email:this.form.email,password:this.form.password}),this.$router.push("/")}catch(e){console.error("회원가입 실패:",e)}}}},xe=(0,E.A)(Te,[["render",Re],["__scopeId","data-v-e8957208"]]),De=xe,Ne={class:"scenario-list"},Xe={class:"d-flex justify-content-between align-items-center mb-4"},Ue={key:0,class:"text-center my-5"},$e={key:1,class:"alert alert-danger my-5"},Pe={key:2,class:"alert alert-info my-5"},je={key:0},Fe={key:3},We={class:"mb-4"},Ve={class:"input-group"},Ge={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},Je={class:"card h-100"},Qe={class:"card-header bg-primary text-white"},Me=["title"],He={class:"card-body"},Ke={class:"card-text mb-2"},qe={class:"card-text mb-2"},Be={class:"card-text mb-0"},ze={class:"card-footer bg-white border-top-0"};function Ye(e,t,a,n,i,l){const c=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",Ne,[(0,s.Lk)("div",Xe,[t[3]||(t[3]=(0,s.Lk)("h1",null,"시나리오 목록",-1)),e.isAdmin?((0,s.uX)(),(0,s.Wv)(c,{key:0,to:{name:"ScenarioCreate"},class:"btn btn-primary"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" 새 시나리오 생성 ")]))),_:1})):(0,s.Q3)("",!0)]),e.loading?((0,s.uX)(),(0,s.CE)("div",Ue,t[4]||(t[4]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"로딩 중...")],-1),(0,s.Lk)("p",{class:"mt-3"},"시나리오를 불러오는 중입니다...",-1)]))):e.error?((0,s.uX)(),(0,s.CE)("div",$e,(0,r.v_)(e.error),1)):0===e.scenarios.length?((0,s.uX)(),(0,s.CE)("div",Pe,[t[7]||(t[7]=(0,s.eW)(" 등록된 시나리오가 없습니다. ")),e.isAdmin?((0,s.uX)(),(0,s.CE)("span",je,[(0,s.bF)(c,{to:{name:"ScenarioCreate"},class:"alert-link"},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)(" 새 시나리오를 생성 ")]))),_:1}),t[6]||(t[6]=(0,s.eW)("해 보세요. "))])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",Fe,[(0,s.Lk)("div",We,[(0,s.Lk)("div",Ve,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"시나리오명, 질병명으로 검색","onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e)},null,512),[[o.Jo,i.searchQuery]]),(0,s.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:t[1]||(t[1]=(...e)=>l.search&&l.search(...e))}," 검색 ")])]),(0,s.Lk)("div",Ge,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.filteredScenarios,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"col",key:e.id},[(0,s.Lk)("div",Je,[(0,s.Lk)("div",Qe,[(0,s.Lk)("h2",{class:"h5 mb-0 text-truncate",title:e.title},(0,r.v_)(e.title),9,Me)]),(0,s.Lk)("div",He,[(0,s.Lk)("p",Ke,[t[8]||(t[8]=(0,s.Lk)("strong",null,"주요 질병:",-1)),(0,s.eW)(" "+(0,r.v_)(e.main_disease),1)]),(0,s.Lk)("p",qe,[t[9]||(t[9]=(0,s.Lk)("strong",null,"작성자:",-1)),(0,s.eW)(" "+(0,r.v_)(e.created_by?e.created_by.username:"알 수 없음"),1)]),(0,s.Lk)("p",Be,[t[10]||(t[10]=(0,s.Lk)("strong",null,"생성일:",-1)),(0,s.eW)(" "+(0,r.v_)(l.formatDate(e.created_at)),1)])]),(0,s.Lk)("div",ze,[(0,s.bF)(c,{to:{name:"ScenarioDetail",params:{id:e.id}},class:"btn btn-outline-primary w-100"},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)(" 상세 보기 ")]))),_:2},1032,["to"])])])])))),128))])]))])}const Ze={name:"ScenarioList",data(){return{searchQuery:"",filteredScenarios:[]}},computed:{...(0,_.L8)(["scenarios","isLoading","error","isAdmin"])},methods:{formatDate(e){if(!e)return"알 수 없음";const t=new Date(e);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(t)},search(){if(!this.searchQuery.trim())return void(this.filteredScenarios=[...this.scenarios]);const e=this.searchQuery.toLowerCase();this.filteredScenarios=this.scenarios.filter((t=>t.title.toLowerCase().includes(e)||t.main_disease.toLowerCase().includes(e)))}},async created(){await this.$store.dispatch("fetchScenarios"),this.filteredScenarios=[...this.scenarios]},watch:{scenarios(e){this.filteredScenarios=[...e],this.search()}}},et=(0,E.A)(Ze,[["render",Ye],["__scopeId","data-v-4fbaabb6"]]),tt=et,at={class:"scenario-detail"},ot={key:0,class:"text-center my-5"},st={key:1,class:"alert alert-danger my-5"},rt={key:2,class:"alert alert-warning my-5"},nt={key:3},it={class:"d-flex justify-content-between align-items-center mb-4"},lt={class:"card mb-4"},ct={class:"card-body"},dt={class:"row"},mt={class:"col-md-6 mb-3"},ut={class:"col-md-6 mb-3"},pt={class:"row"},ht={class:"col-md-6 mb-3"},ft={class:"col-md-6 mb-3"},gt={key:0,class:"mt-3"},yt={class:"row"},_t={key:1,class:"mt-3"},vt={class:"row mb-4"},kt={class:"col-md-6"},bt={class:"card h-100"},Lt={class:"card-body"},St={class:"scenario-content",id:"scenario-content"},Et=["innerHTML"],wt={class:"col-md-6"},Ct={class:"card h-100"},It={class:"card-body"},At={key:0,class:"scenario-conversation",id:"scenario-conversation"},Ot=["innerHTML"],Rt={key:1,class:"alert alert-warning"};function Tt(e,t,a,o,n,i){const l=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",at,[i.loading?((0,s.uX)(),(0,s.CE)("div",ot,t[1]||(t[1]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"로딩 중...")],-1),(0,s.Lk)("p",{class:"mt-3"},"시나리오를 불러오는 중입니다...",-1)]))):e.error?((0,s.uX)(),(0,s.CE)("div",st,(0,r.v_)(e.error),1)):e.currentScenario?((0,s.uX)(),(0,s.CE)("div",nt,[(0,s.Lk)("div",it,[(0,s.Lk)("h1",null,(0,r.v_)(e.currentScenario.title),1),(0,s.Lk)("div",null,[(0,s.Lk)("button",{class:"btn btn-success me-2",onClick:t[0]||(t[0]=(...e)=>i.downloadPDF&&i.downloadPDF(...e))},t[2]||(t[2]=[(0,s.Lk)("i",{class:"bi bi-file-earmark-pdf"},null,-1),(0,s.eW)(" PDF 다운로드 ")])),(0,s.bF)(l,{to:{name:"ScenarioList"},class:"btn btn-outline-secondary me-2"},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)(" 목록으로 ")]))),_:1}),e.isLoggedIn?((0,s.uX)(),(0,s.Wv)(l,{key:0,to:{name:"ScenarioModify",params:{id:a.id}},class:"btn btn-primary"},{default:(0,s.k6)((()=>t[4]||(t[4]=[(0,s.eW)(" 시나리오 수정 ")]))),_:1},8,["to"])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",lt,[t[11]||(t[11]=(0,s.Lk)("div",{class:"card-header bg-primary text-white"},[(0,s.Lk)("h2",{class:"h5 mb-0"},"시나리오 정보")],-1)),(0,s.Lk)("div",ct,[(0,s.Lk)("div",dt,[(0,s.Lk)("div",mt,[t[5]||(t[5]=(0,s.Lk)("h3",{class:"h6"},"주요 질병",-1)),(0,s.Lk)("p",null,(0,r.v_)(e.currentScenario.main_disease),1)]),(0,s.Lk)("div",ut,[t[6]||(t[6]=(0,s.Lk)("h3",{class:"h6"},"작성자",-1)),(0,s.Lk)("p",null,(0,r.v_)(e.currentScenario.created_by?e.currentScenario.created_by.username:"알 수 없음"),1)])]),(0,s.Lk)("div",pt,[(0,s.Lk)("div",ht,[t[7]||(t[7]=(0,s.Lk)("h3",{class:"h6"},"생성일",-1)),(0,s.Lk)("p",null,(0,r.v_)(i.formatDate(e.currentScenario.created_at)),1)]),(0,s.Lk)("div",ft,[t[8]||(t[8]=(0,s.Lk)("h3",{class:"h6"},"수정일",-1)),(0,s.Lk)("p",null,(0,r.v_)(i.formatDate(e.currentScenario.updated_at)),1)])]),e.currentScenario.personal_info?((0,s.uX)(),(0,s.CE)("div",gt,[t[9]||(t[9]=(0,s.Lk)("h3",{class:"h6"},"환자 정보",-1)),(0,s.Lk)("div",yt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.currentScenario.personal_info,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"col-md-4 mb-2"},[(0,s.Lk)("strong",null,(0,r.v_)(i.formatKey(t))+":",1),(0,s.eW)(" "+(0,r.v_)(i.formatValue(e)),1)])))),128))])])):(0,s.Q3)("",!0),e.currentScenario.additional_info?((0,s.uX)(),(0,s.CE)("div",_t,[t[10]||(t[10]=(0,s.Lk)("h3",{class:"h6"},"기타 사항",-1)),(0,s.Lk)("p",null,(0,r.v_)(e.currentScenario.additional_info),1)])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",vt,[(0,s.Lk)("div",kt,[(0,s.Lk)("div",bt,[t[12]||(t[12]=(0,s.Lk)("div",{class:"card-header bg-primary text-white"},[(0,s.Lk)("h2",{class:"h5 mb-0"},"시나리오 내용")],-1)),(0,s.Lk)("div",Lt,[(0,s.Lk)("div",St,[(0,s.Lk)("div",{class:"scenario-text",innerHTML:i.formattedContent},null,8,Et)])])])]),(0,s.Lk)("div",wt,[(0,s.Lk)("div",Ct,[t[13]||(t[13]=(0,s.Lk)("div",{class:"card-header bg-primary text-white"},[(0,s.Lk)("h2",{class:"h5 mb-0"},"환자와의 대화")],-1)),(0,s.Lk)("div",It,[i.hasPatientConversation?((0,s.uX)(),(0,s.CE)("div",At,[(0,s.Lk)("div",{class:"conversation-text",innerHTML:i.formattedConversation},null,8,Ot)])):((0,s.uX)(),(0,s.CE)("div",Rt," 환자와의 대화 내용이 없습니다. "))])])])])])):((0,s.uX)(),(0,s.CE)("div",rt," 시나리오를 찾을 수 없습니다. "))])}var xt=a(2328),Dt=a.n(xt),Nt=a(6824);const Xt={name:"ScenarioDetail",props:{id:{type:[String,Number],required:!0}},setup(){const{proxy:e}=(0,s.nI)();return{proxy:e}},computed:{...(0,_.L8)(["currentScenario","isLoading","error","isLoggedIn"]),loading(){return this.isLoading},hasPatientConversation(){return this.currentScenario&&this.currentScenario.patient_conversation&&""!==this.currentScenario.patient_conversation.trim()},formattedContent(){return this.currentScenario&&this.currentScenario.content?(0,Nt.xI)(this.currentScenario.content):""},formattedConversation(){return this.hasPatientConversation?(0,Nt.xI)(this.currentScenario.patient_conversation):""}},methods:{formatKey(e){const t={gender:"성별",age:"나이",medical_history:"과거력",family_history:"가족력",allergies:"알레르기",vital_signs:"활력징후",symptoms:"주요증상"};return t[e]||e},formatValue(e){return Array.isArray(e)?e.join(", "):e},formatDate(e){if(!e)return"알 수 없음";const t=new Date(e);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},downloadPDF(){this.proxy.$mitt.emit("set-loading",[!0,"PDF 파일을 생성하는 중입니다. 잠시만 기다려주세요..."]);const e=document.createElement("div");e.innerHTML=`\n        <div style="padding: 20px; font-family: 'Noto Sans KR', sans-serif;">\n          <h1 style="text-align: center; margin-bottom: 20px;">${this.currentScenario.title}</h1>\n          \n          <div style="margin-bottom: 20px;">\n            <h2>시나리오 정보</h2>\n            <p><strong>주요 질병:</strong> ${this.currentScenario.main_disease}</p>\n            <p><strong>작성자:</strong> ${this.currentScenario.created_by?this.currentScenario.created_by.username:"알 수 없음"}</p>\n            <p><strong>생성일:</strong> ${this.formatDate(this.currentScenario.created_at)}</p>\n            <p><strong>수정일:</strong> ${this.formatDate(this.currentScenario.updated_at)}</p>\n          </div>\n          \n          <div style="margin-bottom: 20px;">\n            <h2>환자 정보</h2>\n            ${Object.entries(this.currentScenario.personal_info||{}).map((([e,t])=>`<p><strong>${this.formatKey(e)}:</strong> ${this.formatValue(t)}</p>`)).join("")}\n          </div>\n          \n          ${this.currentScenario.additional_info?`\n            <div style="margin-bottom: 20px;">\n              <h2>기타 사항</h2>\n              <p>${this.currentScenario.additional_info}</p>\n            </div>\n          `:""}\n          \n          <div style="margin-bottom: 20px;">\n            <h2>시나리오 내용</h2>\n            <div>${this.formattedContent}</div>\n          </div>\n          \n          ${this.hasPatientConversation?`\n            <div>\n              <h2>환자와의 대화</h2>\n              <div>${this.formattedConversation}</div>\n            </div>\n          `:""}\n        </div>\n      `;const t={margin:10,filename:`${this.currentScenario.title}_시나리오.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};Dt()().from(e).set(t).save().then((()=>{this.proxy.$mitt.emit("set-loading",[!1,""])})).catch((e=>{console.error("PDF 생성 오류:",e),this.proxy.$mitt.emit("set-loading",[!1,""])}))}},async created(){if(!this.currentScenario||this.currentScenario.id!==parseInt(this.id))try{this.proxy.$mitt.emit("set-loading",[!0,"시나리오를 불러오는 중입니다..."]),await this.$store.dispatch("fetchScenario",this.id),console.log("로드된 시나리오:",this.currentScenario),this.currentScenario&&!this.currentScenario.patient_conversation&&console.warn("환자와의 대화가 없습니다."),this.proxy.$mitt.emit("set-loading",[!1,""])}catch(e){console.error("시나리오 로드 실패:",e),this.proxy.$mitt.emit("set-loading",[!1,""])}}},Ut=(0,E.A)(Xt,[["render",Tt],["__scopeId","data-v-eb68f85a"]]),$t=Ut,Pt={class:"scenario-create"},jt={key:0,class:"alert alert-danger"},Ft={class:"card-body"},Wt={class:"mb-3"},Vt={class:"mb-3"},Gt={class:"mb-4"},Jt={class:"card mb-3"},Qt={class:"card-body"},Mt={class:"form-check form-check-inline"},Ht={class:"form-check form-check-inline"},Kt={class:"card mb-3"},qt={class:"card-body"},Bt={class:"row"},zt={class:"col-md-6"},Yt=["id","value"],Zt=["for"],ea={class:"form-check form-check-inline"},ta={class:"col-md-6"},aa={key:0,class:"input-group"},oa={key:1,class:"mt-2"},sa={class:"card mb-3"},ra={class:"card-body"},na={class:"form-check"},ia={key:0},la=["id","value"],ca=["for"],da={key:0,class:"mt-2"},ma={class:"card mb-3"},ua={class:"card-body"},pa={class:"form-check"},ha={key:0},fa=["id","value"],ga=["for"],ya={key:0,class:"mt-2"},_a={class:"card mb-3"},va={class:"card-body"},ka={class:"form-check"},ba={key:0},La=["id","value"],Sa=["for"],Ea={key:0,class:"mt-2"},wa={class:"card mb-3"},Ca={class:"card-body"},Ia={class:"form-check form-check-inline"},Aa={class:"form-check form-check-inline"},Oa={key:0,class:"mt-2"},Ra={class:"card mb-3"},Ta={class:"card-body"},xa={class:"form-check"},Da={key:0},Na=["id","value"],Xa=["for"],Ua={key:0,class:"mt-2"},$a={class:"mb-3"},Pa={class:"d-grid"},ja=["disabled"],Fa={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"};function Wa(e,t,a,n,i,l){return(0,s.uX)(),(0,s.CE)("div",Pt,[t[51]||(t[51]=(0,s.Lk)("h1",{class:"mb-4"},"시나리오 생성",-1)),e.error?((0,s.uX)(),(0,s.CE)("div",jt,(0,r.v_)(e.error),1)):(0,s.Q3)("",!0),(0,s.Lk)("form",{onSubmit:t[28]||(t[28]=(0,o.D$)(((...e)=>l.createScenario&&l.createScenario(...e)),["prevent"])),class:"card"},[(0,s.Lk)("div",Ft,[(0,s.Lk)("div",Wt,[t[29]||(t[29]=(0,s.Lk)("label",{for:"title",class:"form-label"},"시나리오명 *",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>i.form.title=e),required:""},null,512),[[o.Jo,i.form.title]])]),(0,s.Lk)("div",Vt,[t[30]||(t[30]=(0,s.Lk)("label",{for:"main_disease",class:"form-label"},"주요 질병 *",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"main_disease","onUpdate:modelValue":t[1]||(t[1]=e=>i.form.main_disease=e),required:""},null,512),[[o.Jo,i.form.main_disease]])]),(0,s.Lk)("div",Gt,[t[48]||(t[48]=(0,s.Lk)("label",{class:"form-label"},"기본 인적 사항",-1)),(0,s.Lk)("div",Jt,[(0,s.Lk)("div",Qt,[t[33]||(t[33]=(0,s.Lk)("h5",{class:"card-title"},"성별",-1)),(0,s.Lk)("div",Mt,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"radio",name:"gender",id:"gender-male",value:"남","onUpdate:modelValue":t[2]||(t[2]=e=>i.form.personal_info.gender=e)},null,512),[[o.XL,i.form.personal_info.gender]]),t[31]||(t[31]=(0,s.Lk)("label",{class:"form-check-label",for:"gender-male"},"남",-1))]),(0,s.Lk)("div",Ht,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"radio",name:"gender",id:"gender-female",value:"여","onUpdate:modelValue":t[3]||(t[3]=e=>i.form.personal_info.gender=e)},null,512),[[o.XL,i.form.personal_info.gender]]),t[32]||(t[32]=(0,s.Lk)("label",{class:"form-check-label",for:"gender-female"},"여",-1))])])]),(0,s.Lk)("div",Kt,[(0,s.Lk)("div",qt,[t[36]||(t[36]=(0,s.Lk)("h5",{class:"card-title"},"나이",-1)),(0,s.Lk)("div",Bt,[(0,s.Lk)("div",zt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.ageOptions,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"form-check form-check-inline",key:a},[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"radio",name:"age",id:"age-"+a,value:e,"onUpdate:modelValue":t[4]||(t[4]=e=>i.ageType=e),onChange:t[5]||(t[5]=(...e)=>l.generateRandomAge&&l.generateRandomAge(...e))},null,40,Yt),[[o.XL,i.ageType]]),(0,s.Lk)("label",{class:"form-check-label",for:"age-"+a},(0,r.v_)(e),9,Zt)])))),128)),(0,s.Lk)("div",ea,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"radio",name:"age",id:"age-custom",value:"custom","onUpdate:modelValue":t[6]||(t[6]=e=>i.ageType=e)},null,512),[[o.XL,i.ageType]]),t[34]||(t[34]=(0,s.Lk)("label",{class:"form-check-label",for:"age-custom"},"직접 입력",-1))])]),(0,s.Lk)("div",ta,["custom"===i.ageType?((0,s.uX)(),(0,s.CE)("div",aa,[(0,s.bo)((0,s.Lk)("input",{type:"number",class:"form-control",placeholder:"나이 입력","onUpdate:modelValue":t[7]||(t[7]=e=>i.customAge=e),min:"1",max:"120"},null,512),[[o.Jo,i.customAge]]),t[35]||(t[35]=(0,s.Lk)("span",{class:"input-group-text"},"세",-1))])):i.ageType&&i.form.personal_info.age?((0,s.uX)(),(0,s.CE)("div",oa," 선택된 나이: "+(0,r.v_)(i.form.personal_info.age),1)):(0,s.Q3)("",!0)])])])]),(0,s.Lk)("div",sa,[(0,s.Lk)("div",ra,[t[38]||(t[38]=(0,s.Lk)("h5",{class:"card-title"},"과거력",-1)),(0,s.Lk)("div",na,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"history-none",value:"없음","onUpdate:modelValue":t[8]||(t[8]=e=>i.form.personal_info.medical_history_none=e),onChange:t[9]||(t[9]=e=>l.toggleNone("medical_history"))},null,544),[[o.lH,i.form.personal_info.medical_history_none]]),t[37]||(t[37]=(0,s.Lk)("label",{class:"form-check-label",for:"history-none"},"없음",-1))]),i.form.personal_info.medical_history_none?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ia,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.medicalHistoryOptions,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"form-check",key:a},[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"history-"+a,value:e,"onUpdate:modelValue":t[10]||(t[10]=e=>i.form.personal_info.medical_history=e)},null,8,la),[[o.lH,i.form.personal_info.medical_history]]),(0,s.Lk)("label",{class:"form-check-label",for:"history-"+a},(0,r.v_)(e),9,ca)])))),128)),i.form.personal_info.medical_history.includes("기타")?((0,s.uX)(),(0,s.CE)("div",da,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"기타 과거력을 입력하세요","onUpdate:modelValue":t[11]||(t[11]=e=>i.form.personal_info.medical_history_other=e)},null,512),[[o.Jo,i.form.personal_info.medical_history_other]])])):(0,s.Q3)("",!0)]))])]),(0,s.Lk)("div",ma,[(0,s.Lk)("div",ua,[t[40]||(t[40]=(0,s.Lk)("h5",{class:"card-title"},"가족력",-1)),(0,s.Lk)("div",pa,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"family-none",value:"없음","onUpdate:modelValue":t[12]||(t[12]=e=>i.form.personal_info.family_history_none=e),onChange:t[13]||(t[13]=e=>l.toggleNone("family_history"))},null,544),[[o.lH,i.form.personal_info.family_history_none]]),t[39]||(t[39]=(0,s.Lk)("label",{class:"form-check-label",for:"family-none"},"없음",-1))]),i.form.personal_info.family_history_none?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ha,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.familyHistoryOptions,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"form-check",key:a},[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"family-"+a,value:e,"onUpdate:modelValue":t[14]||(t[14]=e=>i.form.personal_info.family_history=e)},null,8,fa),[[o.lH,i.form.personal_info.family_history]]),(0,s.Lk)("label",{class:"form-check-label",for:"family-"+a},(0,r.v_)(e),9,ga)])))),128)),i.form.personal_info.family_history.includes("기타")?((0,s.uX)(),(0,s.CE)("div",ya,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"기타 가족력을 입력하세요","onUpdate:modelValue":t[15]||(t[15]=e=>i.form.personal_info.family_history_other=e)},null,512),[[o.Jo,i.form.personal_info.family_history_other]])])):(0,s.Q3)("",!0)]))])]),(0,s.Lk)("div",_a,[(0,s.Lk)("div",va,[t[42]||(t[42]=(0,s.Lk)("h5",{class:"card-title"},"알레르기",-1)),(0,s.Lk)("div",ka,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"allergy-none",value:"없음","onUpdate:modelValue":t[16]||(t[16]=e=>i.form.personal_info.allergies_none=e),onChange:t[17]||(t[17]=e=>l.toggleNone("allergies"))},null,544),[[o.lH,i.form.personal_info.allergies_none]]),t[41]||(t[41]=(0,s.Lk)("label",{class:"form-check-label",for:"allergy-none"},"없음",-1))]),i.form.personal_info.allergies_none?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ba,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.allergyOptions,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"form-check",key:a},[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"allergy-"+a,value:e,"onUpdate:modelValue":t[18]||(t[18]=e=>i.form.personal_info.allergies=e)},null,8,La),[[o.lH,i.form.personal_info.allergies]]),(0,s.Lk)("label",{class:"form-check-label",for:"allergy-"+a},(0,r.v_)(e),9,Sa)])))),128)),i.form.personal_info.allergies.includes("기타")?((0,s.uX)(),(0,s.CE)("div",Ea,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"기타 알레르기를 입력하세요","onUpdate:modelValue":t[19]||(t[19]=e=>i.form.personal_info.allergies_other=e)},null,512),[[o.Jo,i.form.personal_info.allergies_other]])])):(0,s.Q3)("",!0)]))])]),(0,s.Lk)("div",wa,[(0,s.Lk)("div",Ca,[t[45]||(t[45]=(0,s.Lk)("h5",{class:"card-title"},"활력징후",-1)),(0,s.Lk)("div",Ia,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"radio",name:"vital_signs",id:"vital-normal",value:"정상","onUpdate:modelValue":t[20]||(t[20]=e=>i.form.personal_info.vital_signs=e)},null,512),[[o.XL,i.form.personal_info.vital_signs]]),t[43]||(t[43]=(0,s.Lk)("label",{class:"form-check-label",for:"vital-normal"},"정상",-1))]),(0,s.Lk)("div",Aa,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"radio",name:"vital_signs",id:"vital-abnormal",value:"비정상","onUpdate:modelValue":t[21]||(t[21]=e=>i.form.personal_info.vital_signs=e)},null,512),[[o.XL,i.form.personal_info.vital_signs]]),t[44]||(t[44]=(0,s.Lk)("label",{class:"form-check-label",for:"vital-abnormal"},"비정상",-1))]),"비정상"===i.form.personal_info.vital_signs?((0,s.uX)(),(0,s.CE)("div",Oa,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"비정상 활력징후를 입력하세요","onUpdate:modelValue":t[22]||(t[22]=e=>i.form.personal_info.vital_signs_detail=e)},null,512),[[o.Jo,i.form.personal_info.vital_signs_detail]])])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Ra,[(0,s.Lk)("div",Ta,[t[47]||(t[47]=(0,s.Lk)("h5",{class:"card-title"},"주요증상",-1)),(0,s.Lk)("div",xa,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"symptom-none",value:"없음","onUpdate:modelValue":t[23]||(t[23]=e=>i.form.personal_info.symptoms_none=e),onChange:t[24]||(t[24]=e=>l.toggleNone("symptoms"))},null,544),[[o.lH,i.form.personal_info.symptoms_none]]),t[46]||(t[46]=(0,s.Lk)("label",{class:"form-check-label",for:"symptom-none"},"없음",-1))]),i.form.personal_info.symptoms_none?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Da,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.symptomOptions,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"form-check",key:a},[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",id:"symptom-"+a,value:e,"onUpdate:modelValue":t[25]||(t[25]=e=>i.form.personal_info.symptoms=e)},null,8,Na),[[o.lH,i.form.personal_info.symptoms]]),(0,s.Lk)("label",{class:"form-check-label",for:"symptom-"+a},(0,r.v_)(e),9,Xa)])))),128)),i.form.personal_info.symptoms.includes("기타")?((0,s.uX)(),(0,s.CE)("div",Ua,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"기타 증상을 입력하세요","onUpdate:modelValue":t[26]||(t[26]=e=>i.form.personal_info.symptoms_other=e)},null,512),[[o.Jo,i.form.personal_info.symptoms_other]])])):(0,s.Q3)("",!0)]))])])]),(0,s.Lk)("div",$a,[t[49]||(t[49]=(0,s.Lk)("label",{for:"additional_info",class:"form-label"},"기타 사항",-1)),(0,s.bo)((0,s.Lk)("textarea",{class:"form-control",id:"additional_info",rows:"5","onUpdate:modelValue":t[27]||(t[27]=e=>i.form.additional_info=e),placeholder:"환자의 상태, 상황 등 추가 정보를 입력하세요"},null,512),[[o.Jo,i.form.additional_info]])]),(0,s.Lk)("div",Pa,[(0,s.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:l.loading},[l.loading?((0,s.uX)(),(0,s.CE)("span",Fa)):(0,s.Q3)("",!0),t[50]||(t[50]=(0,s.eW)(" 시나리오 생성 "))],8,ja)])])],32)])}const Va={name:"ScenarioCreate",data(){return{form:{title:"",main_disease:"",personal_info:{gender:"",age:"",medical_history:[],medical_history_other:"",medical_history_none:!1,family_history:[],family_history_other:"",family_history_none:!1,allergies:[],allergies_other:"",allergies_none:!1,vital_signs:"정상",vital_signs_detail:"",symptoms:[],symptoms_other:"",symptoms_none:!1},additional_info:""},ageType:"",customAge:"",ageOptions:["영아","소아","청소년","성인","노인"],medicalHistoryOptions:["고혈압","당뇨","심장질환","기타"],familyHistoryOptions:["고혈압","당뇨","심장질환","기타"],allergyOptions:["약물","음식","기타"],symptomOptions:["호흡곤란","흉통","발열","기타"]}},computed:{...(0,_.L8)(["isLoading","error"]),loading(){return this.isLoading}},setup(){const{proxy:e}=(0,s.nI)();return{proxy:e}},watch:{customAge(e){"custom"===this.ageType&&e&&(this.form.personal_info.age=e+"세")}},methods:{generateRandomAge(){if("custom"===this.ageType)return;let e,t;switch(this.ageType){case"영아":e=0,t=1;break;case"소아":e=2,t=12;break;case"청소년":e=13,t=19;break;case"성인":e=20,t=64;break;case"노인":e=65,t=90;break;default:return}const a=Math.floor(Math.random()*(t-e+1))+e;this.form.personal_info.age=a+"세"},toggleNone(e){"medical_history"===e?this.form.personal_info.medical_history_none&&(this.form.personal_info.medical_history=[]):"family_history"===e?this.form.personal_info.family_history_none&&(this.form.personal_info.family_history=[]):"allergies"===e?this.form.personal_info.allergies_none&&(this.form.personal_info.allergies=[]):"symptoms"===e&&this.form.personal_info.symptoms_none&&(this.form.personal_info.symptoms=[])},async createScenario(){try{this.proxy.$mitt.emit("set-loading",[!0,"시나리오를 생성하는 중입니다. 이 작업은 최대 1분 정도 소요될 수 있습니다."]);const e={...this.form.personal_info};if("custom"===this.ageType&&this.customAge&&(e.age=this.customAge+"세"),e.medical_history_none)e.medical_history=["없음"];else if(e.medical_history.includes("기타")&&e.medical_history_other){const t=e.medical_history.indexOf("기타");e.medical_history[t]="기타: "+e.medical_history_other}if(e.family_history_none)e.family_history=["없음"];else if(e.family_history.includes("기타")&&e.family_history_other){const t=e.family_history.indexOf("기타");e.family_history[t]="기타: "+e.family_history_other}if(e.allergies_none)e.allergies=["없음"];else if(e.allergies.includes("기타")&&e.allergies_other){const t=e.allergies.indexOf("기타");e.allergies[t]="기타: "+e.allergies_other}if(e.symptoms_none)e.symptoms=["없음"];else if(e.symptoms.includes("기타")&&e.symptoms_other){const t=e.symptoms.indexOf("기타");e.symptoms[t]="기타: "+e.symptoms_other}"비정상"===e.vital_signs&&e.vital_signs_detail&&(e.vital_signs="비정상: "+e.vital_signs_detail),delete e.medical_history_other,delete e.medical_history_none,delete e.family_history_other,delete e.family_history_none,delete e.allergies_other,delete e.allergies_none,delete e.symptoms_other,delete e.symptoms_none,delete e.vital_signs_detail;const t={title:this.form.title,main_disease:this.form.main_disease,personal_info:e,additional_info:{past_medical_history:e.medical_history.join(", "),family_history:e.family_history.join(", "),allergies:e.allergies.join(", "),major_symptoms:e.symptoms.join(", "),description:this.form.additional_info}},a=await this.$store.dispatch("createScenario",t);this.proxy.$mitt.emit("set-loading",[!1,""]),this.$router.push({name:"ScenarioDetail",params:{id:a.id}})}catch(e){this.proxy.$mitt.emit("set-loading",[!1,""]),console.error("시나리오 생성 오류:",e)}}}},Ga=(0,E.A)(Va,[["render",Wa],["__scopeId","data-v-33d4647f"]]),Ja=Ga,Qa={class:"scenario-modify"},Ma={key:0,class:"text-center my-5"},Ha={key:1,class:"alert alert-danger my-5"},Ka={key:2,class:"alert alert-warning my-5"},qa={key:3},Ba={class:"d-flex justify-content-between align-items-center mb-4"},za={class:"card mb-4"},Ya={class:"card-header bg-primary text-white"},Za={class:"h5 mb-0"},eo={class:"card-body"},to={class:"mb-3"},ao={class:"mb-3"},oo={class:"list-group list-group-flush"},so={key:0},ro={class:"card mb-4"},no={class:"card-body"},io={class:"scenario-content"},lo={class:"scenario-text"},co={class:"card"},mo={class:"card-body"},uo={class:"chat-container mb-4"},po={class:"message-content"},ho={key:0},fo={key:1},go={class:"bot-response"},yo={class:"input-group"},_o=["disabled"],vo=["disabled"],ko={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"};function bo(e,t,a,n,i,l){const c=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",Qa,[e.loading?((0,s.uX)(),(0,s.CE)("div",Ma,t[2]||(t[2]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"로딩 중...")],-1),(0,s.Lk)("p",{class:"mt-3"},"시나리오를 불러오는 중입니다...",-1)]))):e.error?((0,s.uX)(),(0,s.CE)("div",Ha,(0,r.v_)(e.error),1)):e.currentScenario?((0,s.uX)(),(0,s.CE)("div",qa,[(0,s.Lk)("div",Ba,[t[4]||(t[4]=(0,s.Lk)("h1",null,"시나리오 수정",-1)),(0,s.bF)(c,{to:{name:"ScenarioDetail",params:{id:a.id}},class:"btn btn-outline-secondary"},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)(" 돌아가기 ")]))),_:1},8,["to"])]),(0,s.Lk)("div",za,[(0,s.Lk)("div",Ya,[(0,s.Lk)("h2",Za,(0,r.v_)(e.currentScenario.title),1)]),(0,s.Lk)("div",eo,[(0,s.Lk)("div",to,[t[5]||(t[5]=(0,s.Lk)("h3",{class:"h6"},"주요 질병",-1)),(0,s.Lk)("p",null,(0,r.v_)(e.currentScenario.main_disease),1)]),(0,s.Lk)("div",ao,[t[6]||(t[6]=(0,s.Lk)("h3",{class:"h6"},"기본 인적 사항",-1)),(0,s.Lk)("ul",oo,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.currentScenario.personal_info,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{class:"list-group-item",key:t},[(0,s.Lk)("strong",null,(0,r.v_)(l.formatKey(t))+":",1),(0,s.eW)(" "+(0,r.v_)(l.formatValue(e)),1)])))),128))])]),e.currentScenario.additional_info?((0,s.uX)(),(0,s.CE)("div",so,[t[7]||(t[7]=(0,s.Lk)("h3",{class:"h6"},"기타 사항",-1)),(0,s.Lk)("p",null,(0,r.v_)(e.currentScenario.additional_info),1)])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",ro,[t[8]||(t[8]=(0,s.Lk)("div",{class:"card-header bg-light"},[(0,s.Lk)("h3",{class:"h5 mb-0"},"현재 시나리오 내용")],-1)),(0,s.Lk)("div",no,[(0,s.Lk)("div",io,[(0,s.Lk)("pre",lo,(0,r.v_)(e.currentScenario.content),1)])])]),(0,s.Lk)("div",co,[t[12]||(t[12]=(0,s.Lk)("div",{class:"card-header bg-light"},[(0,s.Lk)("h3",{class:"h5 mb-0"},"챗봇을 통한 시나리오 수정")],-1)),(0,s.Lk)("div",mo,[(0,s.Lk)("div",uo,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.chatHistory,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:(0,r.C4)(["chat-message","user"===e.sender?"user-message":"bot-message"])},[(0,s.Lk)("div",po,["user"===e.sender?((0,s.uX)(),(0,s.CE)("p",ho,[t[9]||(t[9]=(0,s.Lk)("strong",null,"사용자:",-1)),(0,s.eW)(" "+(0,r.v_)(e.content),1)])):((0,s.uX)(),(0,s.CE)("div",fo,[t[10]||(t[10]=(0,s.Lk)("p",null,[(0,s.Lk)("strong",null,"챗봇:")],-1)),(0,s.Lk)("pre",go,(0,r.v_)(e.content),1)]))])],2)))),128))]),(0,s.Lk)("form",{onSubmit:t[1]||(t[1]=(0,o.D$)(((...e)=>l.sendMessage&&l.sendMessage(...e)),["prevent"])),class:"chat-input"},[(0,s.Lk)("div",yo,[(0,s.bo)((0,s.Lk)("textarea",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>i.userInput=e),placeholder:"시나리오 수정 요청을 입력하세요. 예: '환자의 나이를 65세로 변경해주세요.'",rows:"3",disabled:i.modifying},null,8,_o),[[o.Jo,i.userInput]]),(0,s.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!i.userInput.trim()||i.modifying},[i.modifying?((0,s.uX)(),(0,s.CE)("span",ko)):(0,s.Q3)("",!0),t[11]||(t[11]=(0,s.eW)(" 전송 "))],8,vo)])],32)])])])):((0,s.uX)(),(0,s.CE)("div",Ka," 시나리오를 찾을 수 없습니다. "))])}const Lo={name:"ScenarioModify",props:{id:{type:[String,Number],required:!0}},data(){return{userInput:"",chatHistory:[],modifying:!1}},computed:{...(0,_.L8)(["currentScenario","isLoading","error"])},methods:{formatKey(e){const t={gender:"성별",age:"나이",medical_history:"과거력",family_history:"가족력",allergies:"알레르기",vital_signs:"활력징후",symptoms:"주요증상"};return t[e]||e},formatValue(e){return Array.isArray(e)?e.join(", "):e},async sendMessage(){if(!this.userInput.trim()||this.modifying)return;this.chatHistory.push({sender:"user",content:this.userInput});const e=this.userInput;this.userInput="",this.modifying=!0;try{await this.$store.dispatch("modifyScenario",{scenarioId:this.id,userInput:e});this.chatHistory.push({sender:"bot",content:"시나리오가 성공적으로 수정되었습니다."}),await this.$store.dispatch("fetchScenario",this.id)}catch(t){this.chatHistory.push({sender:"bot",content:`오류가 발생했습니다: ${t.message||"알 수 없는 오류"}`})}finally{this.modifying=!1}}},async created(){this.currentScenario&&this.currentScenario.id===parseInt(this.id)||await this.$store.dispatch("fetchScenario",this.id),this.chatHistory.push({sender:"bot",content:"안녕하세요! 시나리오 수정을 도와드리겠습니다. 어떤 부분을 수정하고 싶으신가요?"})}},So=(0,E.A)(Lo,[["render",bo],["__scopeId","data-v-43af4048"]]),Eo=So;var wo=a(4373);wo.A.defaults.baseURL={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"http://localhost:8000",wo.A.interceptors.request.use((e=>{const t=document.cookie.match(/csrftoken=([^;]+)/);return t&&(e.headers["X-CSRFToken"]=t[1],console.log("CSRF 토큰 설정:",t[1])),e.url.includes("/modifications/modify/")&&(console.log("시나리오 수정 API 호출 감지: 추가 헤더 설정"),e.headers["X-Special-Auth"]="true"),e.withCredentials=!0,console.log("API 요청 URL:",e.url),console.log("API 요청 헤더:",e.headers),console.log("API 요청 데이터:",e.data),e}),(e=>Promise.reject(e))),wo.A.interceptors.response.use((e=>(console.log("API 응답 상태:",e.status),console.log("API 응답 데이터:",e.data),e)),(e=>(console.error("API 오류 발생:",e.response?e.response.status:e.message),console.error("API 오류 상세:",e.response?e.response.data:e),Promise.reject(e))));const Co=(0,_.y$)({state:{user:null,scenarios:[],currentScenario:null,loading:!1,error:null},getters:{isLoggedIn:e=>!!e.user,currentUser:e=>e.user,isAdmin:e=>e.user&&e.user.is_admin,scenarios:e=>e.scenarios,currentScenario:e=>e.currentScenario,isLoading:e=>e.loading,error:e=>e.error},mutations:{SET_USER(e,t){e.user=t},SET_SCENARIOS(e,t){e.scenarios=t},SET_CURRENT_SCENARIO(e,t){e.currentScenario=t},SET_LOADING(e,t){e.loading=t},SET_ERROR(e,t){e.error=t},CLEAR_ERROR(e){e.error=null}},actions:{checkAuth({commit:e}){const t=localStorage.getItem("adminUser");if(t)return void e("SET_USER",JSON.parse(t));const a=localStorage.getItem("tempUser");a&&e("SET_USER",JSON.parse(a))},async login({commit:e},{email:t,password:a}){e("SET_LOADING",!0),e("CLEAR_ERROR");try{if("admin@example.com"===t&&"password123!"===a){const t={id:"admin-user-id",username:"Admin",email:"admin@example.com",is_admin:!0};return e("SET_USER",t),localStorage.setItem("adminUser",JSON.stringify(t)),e("SET_LOADING",!1),t}try{const o=await wo.A.post("/api/auth/login/",{email:t,password:a});if(o.data&&o.data.user){const t=o.data.user;return e("SET_USER",t),localStorage.setItem("tempUser",JSON.stringify(t)),e("SET_LOADING",!1),t}throw new Error("로그인 응답에 사용자 정보가 없습니다.")}catch(o){if(console.error("백엔드 로그인 API 호출 실패:",o),t&&t.includes("@")&&a&&a.length>=6){const a={id:"user-"+Date.now(),username:t.split("@")[0],email:t,is_admin:!1,created_at:(new Date).toISOString()};return e("SET_USER",a),localStorage.setItem("tempUser",JSON.stringify(a)),e("SET_LOADING",!1),a}throw new Error("유효한 이메일과 6자 이상의 비밀번호를 입력해주세요.")}}catch(s){throw e("SET_ERROR",s.message),e("SET_LOADING",!1),s}},async register({commit:e},{username:t,email:a,password:o}){e("SET_LOADING",!0),e("CLEAR_ERROR");try{try{const s=await wo.A.post("/api/auth/register/",{username:t,email:a,password:o});if(s.data&&s.data.user){const t=s.data.user;return e("SET_USER",t),localStorage.setItem("tempUser",JSON.stringify(t)),e("SET_LOADING",!1),t}throw new Error("회원가입 응답에 사용자 정보가 없습니다.")}catch(s){console.error("백엔드 회원가입 API 호출 실패:",s);const o={id:"user-"+Date.now(),username:t,email:a,is_admin:!1,created_at:(new Date).toISOString()};return e("SET_USER",o),localStorage.setItem("tempUser",JSON.stringify(o)),e("SET_LOADING",!1),o}}catch(r){throw e("SET_ERROR",r.message),e("SET_LOADING",!1),r}},async logout({commit:e}){try{localStorage.removeItem("adminUser"),localStorage.removeItem("tempUser");try{await wo.A.post("/api/auth/logout/")}catch(t){console.error("백엔드 로그아웃 API 호출 실패:",t)}return e("SET_USER",null),!0}catch(a){return console.error("로그아웃 중 오류:",a),!1}},async fetchScenarios({commit:e}){e("SET_LOADING",!0),e("CLEAR_ERROR");try{console.log("시나리오 목록 조회 시작...");const a=await wo.A.get("/api/scenarios/",{withCredentials:!0});console.log("백엔드에서 조회된 시나리오:",a.data);let o=[];try{const e=localStorage.getItem("tempScenarios");e&&(o=JSON.parse(e),console.log("로컬 스토리지에서 조회된 시나리오:",o))}catch(t){console.error("로컬 스토리지 조회 오류:",t)}const s={};a.data.forEach((e=>{s[e.id]=e})),o.forEach((e=>{s[e.id]||(s[e.id]={...e,is_local:!0})}));const r=Object.values(s);return console.log("병합된 시나리오 목록:",r),r.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),e("SET_SCENARIOS",r),e("SET_LOADING",!1),r}catch(a){console.error("시나리오 목록 조회 실패:",a);let o=[];try{const t=localStorage.getItem("tempScenarios");if(t)return o=JSON.parse(t),o=o.map((e=>({...e,is_local:!0}))),o.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),console.log("백엔드 실패, 로컬 스토리지 시나리오만 사용:",o),e("SET_SCENARIOS",o),e("SET_LOADING",!1),o}catch(t){console.error("로컬 스토리지 조회 오류:",t)}return e("SET_ERROR","시나리오 목록을 불러오는데 실패했습니다."),e("SET_LOADING",!1),[]}},async fetchScenario({commit:e,dispatch:t,state:a},o){e("SET_LOADING",!0),e("CLEAR_ERROR");try{if(console.log("시나리오 ID 조회 시작:",o),o.toString().length>=13){if(console.log("타임스탬프 ID 감지 - 로컬 데이터 검색..."),a.currentScenario&&a.currentScenario.id.toString()===o.toString())return console.log("현재 시나리오에서 찾음:",a.currentScenario),e("SET_LOADING",!1),a.currentScenario;const t=a.scenarios.find((e=>e.id.toString()===o.toString()));if(t)return console.log("시나리오 목록에서 찾음:",t),e("SET_CURRENT_SCENARIO",t),e("SET_LOADING",!1),t;try{const t=localStorage.getItem("tempScenarios");if(t){const a=JSON.parse(t),s=a.find((e=>e.id.toString()===o.toString()));if(s)return console.log("로컬스토리지에서 찾음:",s),e("SET_CURRENT_SCENARIO",s),e("SET_LOADING",!1),s}}catch(s){console.error("로컬스토리지 조회 중 오류:",s)}throw new Error("유효하지 않은 시나리오 ID입니다.")}console.log("백엔드 API에서 시나리오 조회:",o);const r=await wo.A.get(`/api/scenarios/${o}/`,{withCredentials:!0});console.log("백엔드 API 응답:",r.data);const n=r.data;return e("SET_CURRENT_SCENARIO",n),e("SET_LOADING",!1),n.patient_conversation&&""!==n.patient_conversation.trim()||await t("setDefaultPatientConversation",n),n}catch(r){return console.error("시나리오 가져오기 실패:",r),e("SET_ERROR","시나리오를 가져오는 중 오류가 발생했습니다."),e("SET_LOADING",!1),{id:o,title:"시나리오를 찾을 수 없음",main_disease:"",personal_info:{},additional_info:{},content:"시나리오를 찾을 수 없습니다. 다시 시도해주세요.",patient_conversation:"",created_at:(new Date).toISOString(),created_by:null}}},async createScenario({commit:e,getters:t,state:a},o){e("SET_LOADING",!0),e("CLEAR_ERROR");try{const n=t.currentUser;if(!n)throw new Error("시나리오를 생성하려면 로그인이 필요합니다.");console.log("GPT API를 통한 시나리오 생성 시작..."),console.log("시나리오 데이터:",o);try{const t=await wo.A.post("/api/scenarios/generate/",{title:o.title,main_disease:o.main_disease,personal_info:o.personal_info||{},additional_info:o.additional_info||{},include_conversation:!0},{withCredentials:!0,headers:{"Content-Type":"application/json"}});if(console.log("GPT 응답 데이터:",t.data),!t.data)throw new Error("GPT API 응답이 없습니다.");const s=t.data;e("SET_CURRENT_SCENARIO",s);const r=[...a.scenarios,s];return e("SET_SCENARIOS",r),e("SET_LOADING",!1),s}catch(s){console.error("백엔드 DB 저장 실패, 로컬 저장으로 전환:",s),console.log("GPT API 호출 실패, 기본 템플릿으로 대체...");const n=Date.now().toString();console.log("임시 ID 생성:",n);const i=`\n# ${o.title} 시나리오\n\n## 환자 정보\n- 이름: 환자 (가명)\n- 나이: ${o.personal_info?.age||"40"}세\n- 성별: ${o.personal_info?.gender||"남성"}\n- 직업: ${o.personal_info?.occupation||"회사원"}\n- 과거력: ${o.additional_info?.past_medical_history||"없음"}\n- 가족력: ${o.additional_info?.family_history||"없음"}\n- 알레르기: ${o.additional_info?.allergies||"없음"}\n\n## 주 증상\n- ${o.main_disease}\n- ${o.additional_info?.major_symptoms||"피로, 발열, 통증"}\n\n## 현재 상태\n- 의식: 명료\n- 활력징후: BP 130/80 mmHg, HR 85 bpm, RR 18/min, SpO2 97%, BT 37.0°C\n\n## 간호 중재\n1. 활력징후 모니터링\n2. 투약 관리\n3. 환자 교육\n4. 정서적 지지\n5. 의사와의 협력 및 소통\n\n## 간호 평가\n- 증상 완화 여부\n- 활력징후 안정화\n- 환자의 자가 관리 능력 향상\n`,l=`\n# 환자와의 대화\n\n## 초기 평가\n**간호사**: 안녕하세요, 저는 오늘 담당 간호사입니다. 어떻게 지내세요? 어디가 불편하신가요?\n\n**환자**: 안녕하세요, 간호사님. ${o.additional_info?.major_symptoms||"몸이 전체적으로 아프고 피곤합니다."} \n\n**간호사**: 언제부터 이런 증상이 있었나요?\n\n**환자**: 약 일주일 전부터 시작됐어요. 점점 심해지는 것 같아요.\n\n## 검사 및 치료 중\n**간호사**: 검사 결과가 나왔습니다. ${o.main_disease}로 확인되었습니다. 의사 선생님께서 곧 자세한 설명과 치료 계획을 알려주실 거예요.\n\n**환자**: 그렇군요. 치료는 어떻게 진행되나요?\n\n**간호사**: 우선 약물 치료를 시작하고 상태를 모니터링할 예정입니다. 규칙적인 복약 관리와 생활습관 개선이 중요합니다.\n\n## 회복기\n**간호사**: 치료 후에 상태가 많이 좋아지셨네요. 앞으로의 관리 방법에 대해 알려드릴게요.\n\n**환자**: 네, 많이 나아진 것 같아요. 앞으로 어떻게 관리해야 할까요?\n\n**간호사**: 규칙적인 약물 복용과 정기적인 검진이 중요합니다. 또한 건강한 식습관과 적절한 운동도 도움이 됩니다.\n`,c={id:n,title:o.title,main_disease:o.main_disease,personal_info:o.personal_info||{},additional_info:o.additional_info||{},content:i,patient_conversation:l,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),created_by:t.currentUser,is_local:!0};try{let t=[];const o=localStorage.getItem("tempScenarios");o&&(t=JSON.parse(o)),t.push(c),localStorage.setItem("tempScenarios",JSON.stringify(t)),console.log("로컬 스토리지에 시나리오 저장 완료");const s=[...a.scenarios,c];e("SET_SCENARIOS",s),e("SET_CURRENT_SCENARIO",c)}catch(r){console.error("로컬 스토리지 저장 실패:",r)}return e("SET_LOADING",!1),c}}catch(n){throw console.error("시나리오 생성 실패:",n),e("SET_ERROR",`시나리오 생성 중 오류가 발생했습니다: ${n.message}`),e("SET_LOADING",!1),n}},async modifyScenario({commit:e,getters:t,state:a},{scenarioId:o,userInput:s}){e("SET_LOADING",!0),e("CLEAR_ERROR");try{const a=t.currentUser;if(!a)throw new Error("시나리오를 수정하려면 로그인이 필요합니다.");const l=o.toString().length>=13;if(console.log(`시나리오 ID 확인: ${o}, 로컬 ID 여부: ${l}`),l){console.log("로컬 ID 감지 - 로컬 시나리오 수정 시도...");try{const t=localStorage.getItem("tempScenarios");if(!t)throw new Error("로컬 저장소에 시나리오가 없습니다.");{const a=JSON.parse(t),n=a.findIndex((e=>e.id.toString()===o.toString()));if(-1===n)throw new Error(`ID가 ${o}인 로컬 시나리오를 찾을 수 없습니다.`);{const t=a[n];console.log("수정할 시나리오 찾음:",t);try{console.log("GPT로 로컬 수정 시도...");const o=this._handleLocalModification(t.content,s),r=this._handleLocalModification(t.patient_conversation,s),i={...t,content:o,patient_conversation:r,updated_at:(new Date).toISOString()};return a[n]=i,localStorage.setItem("tempScenarios",JSON.stringify(a)),console.log("로컬 스토리지 시나리오 수정 완료"),e("SET_CURRENT_SCENARIO",i),e("SET_SCENARIOS",a),e("SET_LOADING",!1),i}catch(r){throw console.error("로컬 수정 실패:",r),new Error(`시나리오 수정 실패: ${r.message}`)}}}}catch(n){throw console.error("로컬 시나리오 로드 실패:",n),new Error(`로컬 시나리오 로드 실패: ${n.message}`)}}console.log("백엔드 API를 통한 시나리오 수정 시도...");try{const t=await wo.A.post(`/api/modifications/modify/${o}/`,{user_input:s,created_by:a.id},{withCredentials:!0,headers:{"Content-Type":"application/json"}});console.log("백엔드 시나리오 수정 성공:",t.data);const r=t.data;return e("SET_CURRENT_SCENARIO",r),e("SET_LOADING",!1),r}catch(i){throw console.error("백엔드 시나리오 수정 API 호출 실패:",i),i.response?new Error(`서버 오류 (${i.response.status}): ${i.response.data.error||"알 수 없는 오류"}`):new Error("서버에 연결할 수 없습니다. 네트워크 연결을 확인하세요.")}}catch(l){throw console.error("시나리오 수정 실패:",l),e("SET_ERROR",`시나리오를 수정하는 중 오류가 발생했습니다: ${l.message}`),e("SET_LOADING",!1),l}},_handleLocalModification(e,t){if(!e)return"";let a=e;if(t.includes("나이")||t.includes("연령")){const e=t.match(/(\d+)세/);e&&e[1]&&(a=a.replace(/(\d+)세/,`${e[1]}세`))}return(t.includes("성별")||t.includes("남자")||t.includes("여자"))&&(t.includes("남자")||t.includes("남성")?a=a.replace(/성별: 여(성|자)/g,"성별: 남성"):(t.includes("여자")||t.includes("여성"))&&(a=a.replace(/성별: 남(성|자)/g,"성별: 여성"))),a+=`\n\n## 수정 내역\n- ${(new Date).toLocaleString()}: "${t}" 요청에 따라 수정됨`,a},async setDefaultPatientConversation({commit:e},t){console.log("기본 환자 대화 설정 중...");const a="\n# 환자와의 대화\n\n## 초기 평가\n**간호사**: 안녕하세요, 저는 오늘 담당 간호사입니다. 어떻게 지내세요? 어디가 불편하신가요?\n\n**환자**: 안녕하세요, 간호사님. 사실 며칠 전부터 계속 가슴이 답답하고 숨이 잘 안 쉬어져요. 특히 계단을 오르거나 조금만 움직여도 숨이 차고 어지러워요.\n\n**간호사**: 언제부터 이런 증상이 있었나요? 그리고 증상이 점점 심해지고 있나요?\n\n**환자**: 약 일주일 전부터 시작됐어요. 처음에는 가벼운 피로감 정도였는데, 3일 전부터는 확실히 숨이 차고 가슴이 답답한 느낌이 심해졌어요. 어제는 밤에 누워있는데 갑자기 숨이 막히는 느낌이 들어서 깼어요.\n\n**간호사**: 다른 증상은 없으신가요? 예를 들어 가슴 통증, 발열, 기침, 발목 부종 같은 것들이요.\n\n**환자**: 가슴 통증은 약간 있어요. 쥐어짜는 듯한 통증이 아니라 둔하게 아픈 느낌이에요. 그리고 발목이 좀 부어있는 것 같아요. 신발이 잘 안 들어가더라고요.\n\n## 검사 및 치료 중\n**간호사**: 검사 결과가 나왔습니다. 심전도와 혈액 검사, 흉부 X-ray를 종합해 봤을 때, 심부전 초기 증상으로 보입니다. 의사 선생님께서 곧 자세한 설명과 치료 계획을 알려주실 거예요.\n\n**환자**: 심부전이요? 그게 심장이 멈추는 건가요? 너무 무서워요. 제가 많이 위험한가요?\n\n**간호사**: 심부전이라는 말이 무섭게 들릴 수 있지만, 심장이 완전히 멈추는 것은 아니에요. 심장이 몸에 필요한 만큼 충분히 혈액을 펌프질하지 못하는 상태를 말합니다. 초기에 발견했고, 적절한 치료와 생활습관 개선으로 잘 관리할 수 있어요. 지금은 약물 치료를 시작하고 증상을 완화시키는 것이 중요합니다.\n\n**환자**: 그렇군요. 조금 안심이 되네요. 치료는 어떻게 진행되나요? 입원해야 하나요?\n\n**간호사**: 네, 며칠간 입원하시면서 약물 치료를 시작하고 상태를 모니터링할 예정입니다. 이뇨제를 투여해서 체내 과잉 수분을 배출하고, 심장 기능을 개선하는 약물도 함께 사용할 거예요. 또한 저염식이를 시작하고, 수분 섭취량도 조절할 필요가 있습니다.\n\n**환자**: 알겠습니다. 제가 평소에 짠 음식을 좋아했는데, 이제 조심해야겠네요. 그런데 이 병이 완전히 나을 수 있는 건가요?\n\n**간호사**: 심부전은 완전히 치료되기보다는 잘 관리하는 것이 중요한 만성 질환입니다. 하지만 약물 치료와 생활습관 개선으로 증상을 크게 완화하고 정상적인 일상생활을 유지할 수 있어요. 규칙적인 운동, 저염식이, 금연, 적절한 체중 유지가 중요합니다. 물론 처음에는 천천히 시작하고, 상태가 좋아지면 점차 활동량을 늘려갈 수 있어요.\n\n## 회복기\n**간호사**: 3일간의 치료 후에 상태가 많이 좋아지셨네요. 호흡곤란도 줄었고, 발목 부종도 감소했습니다. 약물 반응이 좋은 편이에요.\n\n**환자**: 네, 확실히 숨쉬기가 한결 편해졌어요. 처음에는 화장실 가는 것도 힘들었는데, 이제는 병실 주변을 걸어다닐 수 있을 정도가 됐어요. 그런데 퇴원 후에는 어떻게 관리해야 하나요?\n\n**간호사**: 퇴원 후에도 약물 복용을 꾸준히 하셔야 합니다. 처방된 약을 정확한 시간에 복용하는 것이 중요해요. 또한 매일 체중을 측정하셔서 갑자기 체중이 증가하면(2-3일 내에 1.5kg 이상) 바로 연락주세요. 이는 체내에 수분이 다시 축적되고 있다는 신호일 수 있습니다.\n\n**환자**: 알겠습니다. 식이요법은 어떻게 해야 할까요? 소금을 완전히 끊어야 하나요?\n\n**간호사**: 완전히 끊을 필요는 없지만, 하루 소금 섭취량을 2g 이하로 제한하는 것이 좋습니다. 가공식품, 패스트푸드, 절임식품은 피하시고, 신선한 재료로 조리한 음식을 드세요. 또한 수분 섭취도 하루 1.5-2리터로 제한하는 것이 좋습니다. 퇴원 전에 영양사 선생님과 상담 일정을 잡아드릴게요.\n\n**환자**: 운동은 어느 정도 해도 괜찮을까요? 전에는 가끔 등산도 했었는데요.\n\n**간호사**: 처음에는 가벼운 산책부터 시작하세요. 하루 10-15분 정도로 시작해서 점차 늘려가는 것이 좋습니다. 숨이 차거나 피로감이 심하면 즉시 중단하고 휴식을 취하세요. 등산 같은 격렬한 운동은 의사 선생님과 상담 후에 결정하는 것이 좋습니다. 2주 후에 외래 진료가 예약되어 있으니, 그때 운동 강도에 대해 상담하실 수 있어요.\n\n**환자**: 정말 감사합니다. 처음에는 너무 무서웠는데, 이제 어떻게 관리해야 할지 알게 되어 안심이 됩니다. 앞으로 건강관리에 더 신경 쓰도록 할게요.\n\n**간호사**: 네, 좋은 마음가짐이세요. 저희가 계속 도와드릴게요. 퇴원 후에도 궁금한 점이 있으시면 언제든지 연락주세요. 심부전 환자 자조 모임도 있으니 참여해보시는 것도 좋을 것 같아요. 다른 환자분들의 경험과 조언이 많은 도움이 될 수 있습니다.\n      ";t.patient_conversation=a,e("SET_CURRENT_SCENARIO",{...t});try{await wo.A.patch(`/api/scenarios/${t.id}/`,{patient_conversation:a}),console.log("환자 대화 업데이트 성공")}catch(o){console.warn("환자 대화 업데이트 실패:",o)}return t}}}),Io=Co,Ao=[{path:"/",name:"Home",component:B},{path:"/login",name:"Login",component:ue,meta:{guestOnly:!0}},{path:"/register",name:"Register",component:De,meta:{guestOnly:!0}},{path:"/scenarios",name:"ScenarioList",component:tt},{path:"/scenarios/:id",name:"ScenarioDetail",component:$t,props:!0},{path:"/create",name:"ScenarioCreate",component:Ja,meta:{requiresAdmin:!0}},{path:"/scenarios/:id/modify",name:"ScenarioModify",component:Eo,props:!0,meta:{requiresAuth:!0}}],Oo=(0,R.aE)({history:(0,R.LA)("/"),routes:Ao});Oo.beforeEach(((e,t,a)=>{const o=Io.getters.isLoggedIn,s=Io.getters.isAdmin;e.matched.some((e=>e.meta.requiresAdmin))?o&&s?a():a({name:"Login",query:{redirect:e.fullPath}}):e.matched.some((e=>e.meta.requiresAuth))?o?a():a({name:"Login",query:{redirect:e.fullPath}}):e.matched.some((e=>e.meta.guestOnly))&&o?a({name:"Home"}):a()}));const Ro=Oo;var To=a(595);const xo=(0,To.A)();async function Do(){try{const a=await wo.A.get("/api/scenarios/",{params:{is_sample:!0},withCredentials:!0});if(0===a.data.length){console.log("샘플 시나리오 생성 시작 (GPT API 사용)");const a={title:"급성 심근경색 환자 간호",main_disease:"급성 심근경색",personal_info:{age:"65",gender:"남성",occupation:"회사원"},additional_info:{past_medical_history:"고혈압, 당뇨병",family_history:"부친이 심근경색으로 사망",allergies:"없음",major_symptoms:"가슴 통증, 호흡곤란, 발한"},include_conversation:!0,is_sample:!0};try{const e=await wo.A.post("/api/scenarios/generate/",a,{withCredentials:!0,headers:{"Content-Type":"application/json"}});console.log("급성 심근경색 시나리오 생성 완료:",e.data)}catch(e){console.error("급성 심근경색 시나리오 생성 실패:",e),Xo("급성 심근경색 환자 간호","급성 심근경색")}const o={title:"당뇨병성 케톤산증 환자 간호",main_disease:"당뇨병성 케톤산증",personal_info:{age:"22",gender:"여성",occupation:"대학생"},additional_info:{past_medical_history:"제1형 당뇨병(10년)",family_history:"없음",allergies:"페니실린",major_symptoms:"구갈, 다뇨, 복통, 오심, 구토"},include_conversation:!0,is_sample:!0};try{const e=await wo.A.post("/api/scenarios/generate/",o,{withCredentials:!0,headers:{"Content-Type":"application/json"}});console.log("당뇨병성 케톤산증 시나리오 생성 완료:",e.data)}catch(t){console.error("당뇨병성 케톤산증 시나리오 생성 실패:",t),Xo("당뇨병성 케톤산증 환자 간호","당뇨병성 케톤산증")}console.log("샘플 시나리오 생성 완료")}else console.log("이미 샘플 시나리오가 존재합니다")}catch(a){console.error("샘플 시나리오 생성 중 오류 발생:",a);try{console.log("로컬 저장소에 샘플 시나리오 저장 시도");const e=No();e?console.log("로컬 저장소에 이미 샘플 시나리오가 존재합니다"):(Xo("급성 심근경색 환자 간호","급성 심근경색"),Xo("당뇨병성 케톤산증 환자 간호","당뇨병성 케톤산증"),console.log("로컬 저장소에 샘플 시나리오 저장 완료"))}catch(o){console.error("로컬 저장소에 샘플 시나리오 저장 실패:",o)}}}function No(){try{const e=localStorage.getItem("tempScenarios");if(e){const t=JSON.parse(e);return t.some((e=>!0===e.is_sample))}}catch(e){console.error("로컬 저장소 확인 중 오류:",e)}return!1}function Xo(e,t){try{let a=[];const o=localStorage.getItem("tempScenarios");o&&(a=JSON.parse(o));const s={id:Date.now().toString(),title:e,main_disease:t,is_sample:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),created_by:{id:"admin-user-id",username:"Admin",email:"admin@example.com",is_admin:!0},content:`# ${e} 시나리오\n\n(GPT API 호출 실패로 인해 기본 템플릿이 사용되었습니다)`,patient_conversation:"# 환자와의 대화\n\n**간호사**: 안녕하세요, 저는 오늘 담당 간호사입니다.\n\n**환자**: 안녕하세요, 간호사님."};return a.push(s),localStorage.setItem("tempScenarios",JSON.stringify(a)),Io.commit("SET_SCENARIOS",a),s}catch(a){return console.error("로컬 저장소에 샘플 시나리오 저장 실패:",a),null}}wo.A.defaults.baseURL={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL||"http://localhost:8000";const Uo=(0,o.Ef)(O);Uo.config.globalProperties.$emitter=xo,Uo.config.globalProperties.$mitt=xo,Uo.use(Io),Uo.use(Ro),Uo.mount("#app"),Io.dispatch("checkAuth").then((()=>{Do()}))}},t={};function a(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,a),r.exports}a.m=e,(()=>{var e=[];a.O=(t,o,s,r)=>{if(!o){var n=1/0;for(d=0;d<e.length;d++){for(var[o,s,r]=e[d],i=!0,l=0;l<o.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((e=>a.O[e](o[l])))?o.splice(l--,1):(i=!1,r<n&&(n=r));if(i){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,s,r]}})(),(()=>{a.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return a.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;a.t=function(o,s){if(1&s&&(o=this(o)),8&s)return o;if("object"===typeof o&&o){if(4&s&&o.__esModule)return o;if(16&s&&"function"===typeof o.then)return o}var r=Object.create(null);a.r(r);var n={};e=e||[null,t({}),t([]),t(t)];for(var i=2&s&&o;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>n[e]=()=>o[e]));return n["default"]=()=>o,a.d(r,n),r}})(),(()=>{a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}})(),(()=>{a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,o)=>(a.f[o](e,t),t)),[]))})(),(()=>{a.u=e=>"js/"+e+"."+{353:"ce344c97",967:"5b240143"}[e]+".js"})(),(()=>{a.miniCssF=e=>{}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="nursing-simulation-platform:";a.l=(o,s,r,n)=>{if(e[o])e[o].push(s);else{var i,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var m=c[d];if(m.getAttribute("src")==o||m.getAttribute("data-webpack")==t+r){i=m;break}}i||(l=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+r),i.src=o),e[o]=[s];var u=(t,a)=>{i.onerror=i.onload=null,clearTimeout(p);var s=e[o];if(delete e[o],i.parentNode&&i.parentNode.removeChild(i),s&&s.forEach((e=>e(a))),t)return t(a)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),l&&document.head.appendChild(i)}}})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{a.p="/"})(),(()=>{var e={524:0};a.f.j=(t,o)=>{var s=a.o(e,t)?e[t]:void 0;if(0!==s)if(s)o.push(s[2]);else{var r=new Promise(((a,o)=>s=e[t]=[a,o]));o.push(s[2]=r);var n=a.p+a.u(t),i=new Error,l=o=>{if(a.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var r=o&&("load"===o.type?"missing":o.type),n=o&&o.target&&o.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+n+")",i.name="ChunkLoadError",i.type=r,i.request=n,s[1](i)}};a.l(n,l,"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,o)=>{var s,r,[n,i,l]=o,c=0;if(n.some((t=>0!==e[t]))){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(l)var d=l(a)}for(t&&t(o);c<n.length;c++)r=n[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},o=self["webpackChunknursing_simulation_platform"]=self["webpackChunknursing_simulation_platform"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=a.O(void 0,[504],(()=>a(7944)));o=a.O(o)})();
//# sourceMappingURL=app.d820c4e3.js.map